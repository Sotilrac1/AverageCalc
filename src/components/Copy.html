<html>
  
  <head>
    <title>Average Calculator</title>
    <link rel="stylesheet" type="test/css"  href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    </head>
    
    <body>

      <h1>Average Calculator</h1>
      
      <form id="myForm" onsubmit="return calculateAverage()">
        <input type="number" id="num1" placeholder="Enter first Diameter">
        <input type="number" id="num2" placeholder="Enter second Diameter">
        <input type="number" id="num3" placeholder="Enter third Diameter">
        <input type="submit" value="Calculate Average">
      </form>
      <br><br>
      <table id="results">
        <tr>
          <th>Diameter 1</th>
          <th>Diameter 2</th>
          <th>Diameter 3</th>
          <th>Average</th>
        </tr>
      </table>
      <br><br>
      <button onclick="downloadCSV()">Download as CSV</button>
      
    <script>
        var count = 0;
        var divider = 3;
        function calculateAverage() {
          count++;

          var num1 = document.getElementById("num1").value;
          var num2 = document.getElementById("num2").value;
          var num3 = document.getElementById("num3").value;

          var average = ((parseFloat(num1) /32) + (parseFloat(num2)/32) + (parseFloat(num3))/32) / divider;
          
          var table = document.getElementById("results");
          var row = table.insertRow(count);
          var cell1 = row.insertCell(0);
          var cell2 = row.insertCell(1);
          var cell3 = row.insertCell(2);
          var cell4 = row.insertCell(3);
          cell1.innerHTML = num1;
          cell2.innerHTML = num2;
          cell3.innerHTML = num3;
          cell4.innerHTML = average;

          //clear from on submit
          document.getElementById("myForm").reset();

          return false;
          
        }
      
        function downloadCSV() {
          var csv = [];
          var rows = document.querySelectorAll("table tr");
      
          for (var i = 0; i < rows.length; i++) {
            var row = [], cols = rows[i].querySelectorAll("td, th");
      
            for (var j = 0; j < cols.length; j++) 
              row.push(cols[j].innerText);
              
            csv.push(row.join(","));	
          }
      
          // Download CSV file
          var downloadLink = document.createElement("a");
          var blob = new Blob(["\ufeff" + csv.join("\n")], { type: 'text/csv;charset=utf-8;' });
          var url = URL.createObjectURL(blob);
          downloadLink.href = url;
          downloadLink.download = "results.csv";
          document.body.appendChild(downloadLink);
          downloadLink.click();
          document.body.removeChild(downloadLink);
        }
      </script>
      
      
      
  </body>
</html>
